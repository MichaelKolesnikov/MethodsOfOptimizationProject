# Работа №8
## Решение задачи о назначениях с помощью Венгерского алгоритма
Код решения:
```python
from random import randint  
  
import numpy as np  
from scipy.optimize import linear_sum_assignment  
  
  
def hungarian_algorithm(cost_matrix):  
    cost_matrix = np.array(cost_matrix)  
  
    # Check if the matrix is rectangular and non-empty  
    if len(cost_matrix.shape) != 2 or cost_matrix.shape[0] == 0 or cost_matrix.shape[1] == 0:  
        raise ValueError("Cost matrix must be a non-empty 2D array.")  
  
    row_indices, col_indices = linear_sum_assignment(cost_matrix)  
  
    return row_indices.tolist(), col_indices.tolist()  
  
  
def main():  
    try:  
        n = int(input())  
        should_be_generated = input("Write something to generate table")  
        if should_be_generated:  
            cost_matrix = [[randint(1, 9) for j in range(n)] for _ in range(n)]  
            for i in cost_matrix:  
                print(*i)  
        else:  
            cost_matrix = [list(map(int, input().split())) for _ in range(n)]  
        row_ind, col_ind = hungarian_algorithm(cost_matrix)  
        print("Optimal assignment:")  
        optimal_assignment = [[0 for j in range(n)] for i in range(n)]  
        for r, c in zip(row_ind, col_ind):  
            optimal_assignment[r][c] = 1  
        for i in optimal_assignment:  
            print(*i)  
  
        total_cost = sum(cost_matrix[r][c] for r, c in zip(row_ind, col_ind))  
        print(f"Total cost: {total_cost}")  
    except Exception as e:  
        print(f"Error: {e}")  
  
  
if __name__ == "__main__":  
    main()
```
Ввод-вывод:
10
```matrix
1 6 5 5 8 2 8 4 6 8
9 9 1 6 3 2 4 8 9 9
2 5 2 6 8 8 2 3 9 7
8 8 8 6 7 9 5 2 2 2
5 2 7 5 7 4 7 9 4 2
1 3 7 7 2 8 7 1 4 7
5 6 9 2 3 6 8 5 8 3
8 9 6 7 5 9 2 3 7 3
2 2 2 9 8 8 2 1 5 1
2 6 8 4 8 6 7 9 5 7
```
Optimal assignment:
```matrix
0 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 0 0 0 0
0 0 0 0 0 0 0 1 0 0
0 0 0 0 0 0 0 0 1 0
0 1 0 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0
0 0 0 0 0 0 1 0 0 0
0 0 0 0 0 0 0 0 0 1
1 0 0 0 0 0 0 0 0 0
```
Total cost: 19
## Решение руками
Исходная матрица имеет вид:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|1|6|5|5|8|2|8|4|6|8|
|9|9|1|6|3|2|4|8|9|9|
|2|5|2|6|8|8|2|3|9|7|
|8|8|8|6|7|9|5|2|2|2|
|5|2|7|5|7|4|7|9|4|2|
|1|3|7|7|2|8|7|1|4|7|
|5|6|9|2|3|6|8|5|8|3|
|8|9|6|7|5|9|2|3|7|3|
|2|2|2|9|8|8|2|1|5|1|
|2|6|8|4|8|6|7|9|5|7|

  
**Шаг №1**.  
**1. Проводим редукцию матрицы по строкам**. В связи с этим во вновь полученной матрице в каждой строке будет как минимум один ноль.  

|   |   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|---|
|0|5|4|4|7|1|7|3|5|7|**1**|
|8|8|0|5|2|1|3|7|8|8|**1**|
|0|3|0|4|6|6|0|1|7|5|**2**|
|6|6|6|4|5|7|3|0|0|0|**2**|
|3|0|5|3|5|2|5|7|2|0|**2**|
|0|2|6|6|1|7|6|0|3|6|**1**|
|3|4|7|0|1|4|6|3|6|1|**2**|
|6|7|4|5|3|7|0|1|5|1|**2**|
|1|1|1|8|7|7|1|0|4|0|**1**|
|0|4|6|2|6|4|5|7|3|5|**2**|

  
Затем такую же операцию редукции проводим по столбцам, для чего в каждом столбце находим минимальный элемент.  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|0|5|4|4|6|0|7|3|5|7|
|8|8|0|5|1|0|3|7|8|8|
|0|3|0|4|5|5|0|1|7|5|
|6|6|6|4|4|6|3|0|0|0|
|3|0|5|3|4|1|5|7|2|0|
|0|2|6|6|0|6|6|0|3|6|
|3|4|7|0|0|3|6|3|6|1|
|6|7|4|5|2|6|0|1|5|1|
|1|1|1|8|6|6|1|0|4|0|
|0|4|6|2|5|3|5|7|3|5|
|**0**|**0**|**0**|**0**|**1**|**1**|**0**|**0**|**0**|**0**|

  
После вычитания минимальных элементов получаем полностью редуцированную матрицу.  
**2. Методом проб и ошибок** проводим поиск допустимого решения, для которого все назначения имеют нулевую стоимость.  
Фиксируем нулевое значение в клетке (1, 6). Другие нули в строке 1 и столбце 6 вычеркиваем. Для данной клетки вычеркиваем нули в клетках (2; 6), (1; 1).
...
В итоге получаем следующую матрицу:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|[-0-]|5|4|4|6|**[0]**|7|3|5|7|
|8|8|**[0]**|5|1|[-0-]|3|7|8|8|
|[-0-]|3|[-0-]|4|5|5|**[0]**|1|7|5|
|6|6|6|4|4|6|3|[-0-]|[-0-]|**[0]**|
|3|**[0]**|5|3|4|1|5|7|2|[-0-]|
|[-0-]|2|6|6|[-0-]|6|6|**[0]**|3|6|
|3|4|7|[-0-]|**[0]**|3|6|3|6|1|
|6|7|4|5|2|6|[-0-]|1|5|1|
|1|1|1|8|6|6|1|[-0-]|4|[-0-]|
|0|4|6|2|5|3|5|7|3|5|

  
Поскольку расположение нулевых элементов в матрице не позволяет образовать систему из 10-х независимых нулей (в матрице их только 7), то **решение недопустимое**.  
**3. Проводим модификацию матрицы**. Вычеркиваем строки и столбцы с возможно большим количеством нулевых элементов:  
столбец 1, строку 4, строку 2, столбец 5, строку 3, столбец 8, строку 5, столбец 4, строку 1, столбец 7, строку 9  
Получаем сокращенную матрицу (элементы выделены):  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|0|5|4|4|6|0|7|3|5|7|
|8|8|0|5|1|0|3|7|8|8|
|0|3|0|4|5|5|0|1|7|5|
|6|6|6|4|4|6|3|0|0|0|
|3|0|5|3|4|1|5|7|2|0|
|0|**2**|**6**|6|0|**6**|6|0|**3**|**6**|
|3|**4**|**7**|0|0|**3**|6|3|**6**|**1**|
|6|**7**|**4**|5|2|**6**|0|1|**5**|**1**|
|1|1|1|8|6|6|1|0|4|0|
|0|**4**|**6**|2|5|**3**|5|7|**3**|**5**|

  
Минимальный элемент сокращенной матрицы (min(2, 6, 6, 3, 6, 4, 7, 3, 6, 1, 7, 4, 6, 5, 1, 4, 6, 3, 3, 5) = 1) вычитаем из всех ее элементов:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|0|5|4|4|6|0|7|3|5|7|
|8|8|0|5|1|0|3|7|8|8|
|0|3|0|4|5|5|0|1|7|5|
|6|6|6|4|4|6|3|0|0|0|
|3|0|5|3|4|1|5|7|2|0|
|0|**1**|**5**|6|0|**5**|6|0|**2**|**5**|
|3|**3**|**6**|0|0|**2**|6|3|**5**|**0**|
|6|**6**|**3**|5|2|**5**|0|1|**4**|**0**|
|1|1|1|8|6|6|1|0|4|0|
|0|**3**|**5**|2|5|**2**|5|7|**2**|**4**|

  
Затем складываем минимальный элемент с элементами, расположенными на пересечениях вычеркнутых строк и столбцов:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|**1**|5|4|**5**|**7**|0|**8**|**4**|5|7|
|**9**|8|0|**6**|**2**|0|**4**|**8**|8|8|
|**1**|3|0|**5**|**6**|5|**1**|**2**|7|5|
|**7**|6|6|**5**|**5**|6|**4**|**1**|0|0|
|**4**|0|5|**4**|**5**|1|**6**|**8**|2|0|
|0|1|5|6|0|5|6|0|2|5|
|3|3|6|0|0|2|6|3|5|0|
|6|6|3|5|2|5|0|1|4|0|
|**2**|1|1|**9**|**7**|6|**2**|**1**|4|0|
|0|3|5|2|5|2|5|7|2|4|

  
**Шаг №2**.  
**1. Проводим редукцию матрицы по строкам**. В связи с этим во вновь полученной матрице в каждой строке будет как минимум один ноль.  
Затем такую же операцию редукции проводим по столбцам, для чего в каждом столбце находим минимальный элемент.  
После вычитания минимальных элементов получаем полностью редуцированную матрицу.  
**2. Методом проб и ошибок** проводим поиск допустимого решения, для которого все назначения имеют нулевую стоимость.  
Фиксируем нулевое значение в клетке (1, 6). Другие нули в строке 1 и столбце 6 вычеркиваем. Для данной клетки вычеркиваем нули в клетках (2; 6)  
Фиксируем нулевое значение в клетке (2, 3). Другие нули в строке 2 и столбце 3 вычеркиваем. Для данной клетки вычеркиваем нули в клетках (3; 3)  
В итоге получаем следующую матрицу:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|1|5|4|5|7|**[0]**|8|4|5|7|
|9|8|**[0]**|6|2|[-0-]|4|8|8|8|
|1|3|[-0-]|5|6|5|1|2|7|5|
|7|6|6|5|5|6|4|1|0|0|
|4|0|5|4|5|1|6|8|2|0|
|0|1|5|6|0|5|6|0|2|5|
|3|3|6|0|0|2|6|3|5|0|
|6|6|3|5|2|5|0|1|4|0|
|2|1|1|9|7|6|2|1|4|0|
|0|3|5|2|5|2|5|7|2|4|

  
Поскольку расположение нулевых элементов в матрице не позволяет образовать систему из 10-х независимых нулей (в матрице их только 2), то **решение недопустимое**.  
**3. Проводим модификацию матрицы**. Вычеркиваем строки и столбцы с возможно большим количеством нулевых элементов:  
столбец 10, строку 6, строку 2, строку 7, столбец 1, столбец 2, строку 1, столбец 3, строку 4, столбец 7  
Получаем сокращенную матрицу (элементы выделены):  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|1|5|4|5|7|0|8|4|5|7|
|9|8|0|6|2|0|4|8|8|8|
|1|3|0|**5**|**6**|**5**|1|**2**|**7**|5|
|7|6|6|5|5|6|4|1|0|0|
|4|0|5|**4**|**5**|**1**|6|**8**|**2**|0|
|0|1|5|6|0|5|6|0|2|5|
|3|3|6|0|0|2|6|3|5|0|
|6|6|3|**5**|**2**|**5**|0|**1**|**4**|0|
|2|1|1|**9**|**7**|**6**|2|**1**|**4**|0|
|0|3|5|**2**|**5**|**2**|5|**7**|**2**|4|

  
Минимальный элемент сокращенной матрицы (min(5, 6, 5, 2, 7, 4, 5, 1, 8, 2, 5, 2, 5, 1, 4, 9, 7, 6, 1, 4, 2, 5, 2, 7, 2) = 1) вычитаем из всех ее элементов:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|1|5|4|5|7|0|8|4|5|7|
|9|8|0|6|2|0|4|8|8|8|
|1|3|0|**4**|**5**|**4**|1|**1**|**6**|5|
|7|6|6|5|5|6|4|1|0|0|
|4|0|5|**3**|**4**|**0**|6|**7**|**1**|0|
|0|1|5|6|0|5|6|0|2|5|
|3|3|6|0|0|2|6|3|5|0|
|6|6|3|**4**|**1**|**4**|0|**0**|**3**|0|
|2|1|1|**8**|**6**|**5**|2|**0**|**3**|0|
|0|3|5|**1**|**4**|**1**|5|**6**|**1**|4|

  
Затем складываем минимальный элемент с элементами, расположенными на пересечениях вычеркнутых строк и столбцов:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|**2**|**6**|**5**|5|7|0|**9**|4|5|**8**|
|**10**|**9**|**1**|6|2|0|**5**|8|8|**9**|
|1|3|0|4|5|4|1|1|6|5|
|**8**|**7**|**7**|5|5|6|**5**|1|0|**1**|
|4|0|5|3|4|0|6|7|1|0|
|**1**|**2**|**6**|6|0|5|**7**|0|2|**6**|
|**4**|**4**|**7**|0|0|2|**7**|3|5|**1**|
|6|6|3|4|1|4|0|0|3|0|
|2|1|1|8|6|5|2|0|3|0|
|0|3|5|1|4|1|5|6|1|4|

  
**Шаг №3**.  
**1. Проводим редукцию матрицы по строкам**. В связи с этим во вновь полученной матрице в каждой строке будет как минимум один ноль.  
Затем такую же операцию редукции проводим по столбцам, для чего в каждом столбце находим минимальный элемент.  
После вычитания минимальных элементов получаем полностью редуцированную матрицу.  
**2. Методом проб и ошибок** проводим поиск допустимого решения, для которого все назначения имеют нулевую стоимость.  
Фиксируем нулевое значение в клетке (1, 6). Другие нули в строке 1 и столбце 6 вычеркиваем. Для данной клетки вычеркиваем нули в клетках (2; 6), (5; 6)  
В итоге получаем следующую матрицу:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|2|6|5|5|7|**[0]**|9|4|5|8|
|10|9|1|6|2|[-0-]|5|8|8|9|
|1|3|0|4|5|4|1|1|6|5|
|8|7|7|5|5|6|5|1|0|1|
|4|0|5|3|4|[-0-]|6|7|1|0|
|1|2|6|6|0|5|7|0|2|6|
|4|4|7|0|0|2|7|3|5|1|
|6|6|3|4|1|4|0|0|3|0|
|2|1|1|8|6|5|2|0|3|0|
|0|3|5|1|4|1|5|6|1|4|

  
Поскольку расположение нулевых элементов в матрице не позволяет образовать систему из 10-х независимых нулей (в матрице их только 1), то **решение недопустимое**.  
**3. Проводим модификацию матрицы**. Вычеркиваем строки и столбцы с возможно большим количеством нулевых элементов:  
строку 5, столбец 8, строку 7, столбец 6, строку 8, столбец 1, строку 3, столбец 5, строку 4, столбец 10  
Получаем сокращенную матрицу (элементы выделены):  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|2|**6**|**5**|**5**|7|0|**9**|4|**5**|8|
|10|**9**|**1**|**6**|2|0|**5**|8|**8**|9|
|1|3|0|4|5|4|1|1|6|5|
|8|7|7|5|5|6|5|1|0|1|
|4|0|5|3|4|0|6|7|1|0|
|1|**2**|**6**|**6**|0|5|**7**|0|**2**|6|
|4|4|7|0|0|2|7|3|5|1|
|6|6|3|4|1|4|0|0|3|0|
|2|**1**|**1**|**8**|6|5|**2**|0|**3**|0|
|0|**3**|**5**|**1**|4|1|**5**|6|**1**|4|

  
Минимальный элемент сокращенной матрицы (min(6, 5, 5, 9, 5, 9, 1, 6, 5, 8, 2, 6, 6, 7, 2, 1, 1, 8, 2, 3, 3, 5, 1, 5, 1) = 1) вычитаем из всех ее элементов:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|2|**5**|**4**|**4**|7|0|**8**|4|**4**|8|
|10|**8**|**0**|**5**|2|0|**4**|8|**7**|9|
|1|3|0|4|5|4|1|1|6|5|
|8|7|7|5|5|6|5|1|0|1|
|4|0|5|3|4|0|6|7|1|0|
|1|**1**|**5**|**5**|0|5|**6**|0|**1**|6|
|4|4|7|0|0|2|7|3|5|1|
|6|6|3|4|1|4|0|0|3|0|
|2|**0**|**0**|**7**|6|5|**1**|0|**2**|0|
|0|**2**|**4**|**0**|4|1|**4**|6|**0**|4|

  
Затем складываем минимальный элемент с элементами, расположенными на пересечениях вычеркнутых строк и столбцов:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|2|5|4|4|7|0|8|4|4|8|
|10|8|0|5|2|0|4|8|7|9|
|**2**|3|0|4|**6**|**5**|1|**2**|6|**6**|
|**9**|7|7|5|**6**|**7**|5|**2**|0|**2**|
|**5**|0|5|3|**5**|**1**|6|**8**|1|**1**|
|1|1|5|5|0|5|6|0|1|6|
|**5**|4|7|0|**1**|**3**|7|**4**|5|**2**|
|**7**|6|3|4|**2**|**5**|0|**1**|3|**1**|
|2|0|0|7|6|5|1|0|2|0|
|0|2|4|0|4|1|4|6|0|4|

  
**Шаг №4**.  
**1. Проводим редукцию матрицы по строкам**. В связи с этим во вновь полученной матрице в каждой строке будет как минимум один ноль.  
Затем такую же операцию редукции проводим по столбцам, для чего в каждом столбце находим минимальный элемент.  
После вычитания минимальных элементов получаем полностью редуцированную матрицу.  
**2. Методом проб и ошибок** проводим поиск допустимого решения, для которого все назначения имеют нулевую стоимость.  
Фиксируем нулевое значение в клетке (1, 6). Другие нули в строке 1 и столбце 6 вычеркиваем. Для данной клетки вычеркиваем нули в клетках (2; 6)  
Фиксируем нулевое значение в клетке (2, 3). Другие нули в строке 2 и столбце 3 вычеркиваем. Для данной клетки вычеркиваем нули в клетках (3; 3), (9; 3)  
В итоге получаем следующую матрицу:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|2|5|4|4|7|**[0]**|8|4|4|8|
|10|8|**[0]**|5|2|[-0-]|4|8|7|9|
|2|3|[-0-]|4|6|5|1|2|6|6|
|9|7|7|5|6|7|5|2|0|2|
|5|0|5|3|5|1|6|8|1|1|
|1|1|5|5|0|5|6|0|1|6|
|5|4|7|0|1|3|7|4|5|2|
|7|6|3|4|2|5|0|1|3|1|
|2|0|[-0-]|7|6|5|1|0|2|0|
|0|2|4|0|4|1|4|6|0|4|

  
Поскольку расположение нулевых элементов в матрице не позволяет образовать систему из 10-х независимых нулей (в матрице их только 2), то **решение недопустимое**.  
**3. Проводим модификацию матрицы**. Вычеркиваем строки и столбцы с возможно большим количеством нулевых элементов:  
строку 9, строку 10, столбец 3, столбец 6, строку 6, столбец 2, строку 4, столбец 4, строку 8  
Получаем сокращенную матрицу (элементы выделены):  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|**2**|5|4|4|**7**|0|**8**|**4**|**4**|**8**|
|**10**|8|0|5|**2**|0|**4**|**8**|**7**|**9**|
|**2**|3|0|4|**6**|5|**1**|**2**|**6**|**6**|
|9|7|7|5|6|7|5|2|0|2|
|**5**|0|5|3|**5**|1|**6**|**8**|**1**|**1**|
|1|1|5|5|0|5|6|0|1|6|
|**5**|4|7|0|**1**|3|**7**|**4**|**5**|**2**|
|7|6|3|4|2|5|0|1|3|1|
|2|0|0|7|6|5|1|0|2|0|
|0|2|4|0|4|1|4|6|0|4|

  
Минимальный элемент сокращенной матрицы (min(2, 7, 8, 4, 4, 8, 10, 2, 4, 8, 7, 9, 2, 6, 1, 2, 6, 6, 5, 5, 6, 8, 1, 1, 5, 1, 7, 4, 5, 2) = 1) вычитаем из всех ее элементов:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|**1**|5|4|4|**6**|0|**7**|**3**|**3**|**7**|
|**9**|8|0|5|**1**|0|**3**|**7**|**6**|**8**|
|**1**|3|0|4|**5**|5|**0**|**1**|**5**|**5**|
|9|7|7|5|6|7|5|2|0|2|
|**4**|0|5|3|**4**|1|**5**|**7**|**0**|**0**|
|1|1|5|5|0|5|6|0|1|6|
|**4**|4|7|0|**0**|3|**6**|**3**|**4**|**1**|
|7|6|3|4|2|5|0|1|3|1|
|2|0|0|7|6|5|1|0|2|0|
|0|2|4|0|4|1|4|6|0|4|

  
Затем складываем минимальный элемент с элементами, расположенными на пересечениях вычеркнутых строк и столбцов:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|1|5|4|4|6|0|7|3|3|7|
|9|8|0|5|1|0|3|7|6|8|
|1|3|0|4|5|5|0|1|5|5|
|9|**8**|**8**|**6**|6|**8**|5|2|0|2|
|4|0|5|3|4|1|5|7|0|0|
|1|**2**|**6**|**6**|0|**6**|6|0|1|6|
|4|4|7|0|0|3|6|3|4|1|
|7|**7**|**4**|**5**|2|**6**|0|1|3|1|
|2|**1**|**1**|**8**|6|**6**|1|0|2|0|
|0|**3**|**5**|**1**|4|**2**|4|6|0|4|

  
**Шаг №5**.  
**1. Проводим редукцию матрицы по строкам**. В связи с этим во вновь полученной матрице в каждой строке будет как минимум один ноль.  
Затем такую же операцию редукции проводим по столбцам, для чего в каждом столбце находим минимальный элемент.  
После вычитания минимальных элементов получаем полностью редуцированную матрицу.  
**2. Методом проб и ошибок** проводим поиск допустимого решения, для которого все назначения имеют нулевую стоимость.  
Фиксируем нулевое значение в клетке (1, 6). Другие нули в строке 1 и столбце 6 вычеркиваем. Для данной клетки вычеркиваем нули в клетках (2; 6)  
Фиксируем нулевое значение в клетке (2, 3). Другие нули в строке 2 и столбце 3 вычеркиваем. Для данной клетки вычеркиваем нули в клетках (3; 3)  
...
В итоге получаем следующую матрицу:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|1|5|4|4|6|**[0]**|7|3|3|7|
|9|8|**[0]**|5|1|[-0-]|3|7|6|8|
|1|3|[-0-]|4|5|5|**[0]**|1|5|5|
|9|8|8|6|6|8|5|2|**[0]**|2|
|4|[-0-]|5|3|4|1|5|7|[-0-]|**[0]**|
|1|2|6|6|[-0-]|6|6|**[0]**|1|6|
|4|4|7|[-0-]|**[0]**|3|6|3|4|1|
|7|7|4|5|2|6|[-0-]|1|3|1|
|2|1|1|8|6|6|1|[-0-]|2|[-0-]|
|0|3|5|1|4|2|4|6|[-0-]|4|

  
Поскольку расположение нулевых элементов в матрице не позволяет образовать систему из 10-х независимых нулей (в матрице их только 7), то **решение недопустимое**.  
**3. Проводим модификацию матрицы**. Вычеркиваем строки и столбцы с возможно большим количеством нулевых элементов:  
строку 5, столбец 3, строку 6, столбец 6, строку 7, столбец 7, строку 9, столбец 9, строку 10  
Получаем сокращенную матрицу (элементы выделены):  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|**1**|**5**|4|**4**|**6**|0|7|**3**|3|**7**|
|**9**|**8**|0|**5**|**1**|0|3|**7**|6|**8**|
|**1**|**3**|0|**4**|**5**|5|0|**1**|5|**5**|
|**9**|**8**|8|**6**|**6**|8|5|**2**|0|**2**|
|4|0|5|3|4|1|5|7|0|0|
|1|2|6|6|0|6|6|0|1|6|
|4|4|7|0|0|3|6|3|4|1|
|**7**|**7**|4|**5**|**2**|6|0|**1**|3|**1**|
|2|1|1|8|6|6|1|0|2|0|
|0|3|5|1|4|2|4|6|0|4|

  
Минимальный элемент сокращенной матрицы (min(1, 5, 4, 6, 3, 7, 9, 8, 5, 1, 7, 8, 1, 3, 4, 5, 1, 5, 9, 8, 6, 6, 2, 2, 7, 7, 5, 2, 1, 1) = 1) вычитаем из всех ее элементов:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|**0**|**4**|4|**3**|**5**|0|7|**2**|3|**6**|
|**8**|**7**|0|**4**|**0**|0|3|**6**|6|**7**|
|**0**|**2**|0|**3**|**4**|5|0|**0**|5|**4**|
|**8**|**7**|8|**5**|**5**|8|5|**1**|0|**1**|
|4|0|5|3|4|1|5|7|0|0|
|1|2|6|6|0|6|6|0|1|6|
|4|4|7|0|0|3|6|3|4|1|
|**6**|**6**|4|**4**|**1**|6|0|**0**|3|**0**|
|2|1|1|8|6|6|1|0|2|0|
|0|3|5|1|4|2|4|6|0|4|

  
Затем складываем минимальный элемент с элементами, расположенными на пересечениях вычеркнутых строк и столбцов:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|0|4|4|3|5|0|7|2|3|6|
|8|7|0|4|0|0|3|6|6|7|
|0|2|0|3|4|5|0|0|5|4|
|8|7|8|5|5|8|5|1|0|1|
|4|0|**6**|3|4|**2**|**6**|7|**1**|0|
|1|2|**7**|6|0|**7**|**7**|0|**2**|6|
|4|4|**8**|0|0|**4**|**7**|3|**5**|1|
|6|6|4|4|1|6|0|0|3|0|
|2|1|**2**|8|6|**7**|**2**|0|**3**|0|
|0|3|**6**|1|4|**3**|**5**|6|**1**|4|

  
**Шаг №6**.  
**1. Проводим редукцию матрицы по строкам**. В связи с этим во вновь полученной матрице в каждой строке будет как минимум один ноль.  
Затем такую же операцию редукции проводим по столбцам, для чего в каждом столбце находим минимальный элемент.  
После вычитания минимальных элементов получаем полностью редуцированную матрицу.  
**2. Методом проб и ошибок** проводим поиск допустимого решения, для которого все назначения имеют нулевую стоимость.  
Фиксируем нулевое значение в клетке (1, 6). Другие нули в строке 1 и столбце 6 вычеркиваем. Для данной клетки вычеркиваем нули в клетках (2; 6), (1; 1).  
...
В итоге получаем следующую матрицу:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|[-0-]|4|4|3|5|**[0]**|7|2|3|6|
|8|7|**[0]**|4|[-0-]|[-0-]|3|6|6|7|
|[-0-]|2|[-0-]|3|4|5|**[0]**|[-0-]|5|4|
|8|7|8|5|5|8|5|1|**[0]**|1|
|4|**[0]**|6|3|4|2|6|7|1|[-0-]|
|1|2|7|6|**[0]**|7|7|[-0-]|2|6|
|4|4|8|**[0]**|[-0-]|4|7|3|5|1|
|6|6|4|4|1|6|[-0-]|**[0]**|3|[-0-]|
|2|1|2|8|6|7|2|[-0-]|3|**[0]**|
|**[0]**|3|6|1|4|3|5|6|1|4|

  
Количество найденных нулей равно k = 10. В результате получаем эквивалентную матрицу Сэ:  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|0|4|4|3|5|0|7|2|3|6|
|8|7|0|4|0|0|3|6|6|7|
|0|2|0|3|4|5|0|0|5|4|
|8|7|8|5|5|8|5|1|0|1|
|4|0|6|3|4|2|6|7|1|0|
|1|2|7|6|0|7|7|0|2|6|
|4|4|8|0|0|4|7|3|5|1|
|6|6|4|4|1|6|0|0|3|0|
|2|1|2|8|6|7|2|0|3|0|
|0|3|6|1|4|3|5|6|1|4|

  
**4. Методом проб и ошибок определяем матрицу назначения Х**, которая позволяет по аналогично расположенным элементам исходной матрицы (в квадратах) вычислить минимальную стоимость назначения.  

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|[-0-]|4|4|3|5|**[0]**|7|2|3|6|
|8|7|**[0]**|4|[-0-]|[-0-]|3|6|6|7|
|[-0-]|2|[-0-]|3|4|5|[-0-]|**[0]**|5|4|
|8|7|8|5|5|8|5|1|**[0]**|1|
|4|**[0]**|6|3|4|2|6|7|1|[-0-]|
|1|2|7|6|**[0]**|7|7|[-0-]|2|6|
|4|4|8|**[0]**|[-0-]|4|7|3|5|1|
|6|6|4|4|1|6|**[0]**|[-0-]|3|[-0-]|
|2|1|2|8|6|7|2|[-0-]|3|**[0]**|
|**[0]**|3|6|1|4|3|5|6|1|4|

Ответ:
Cmin = 2 + 2 + 2 + 2 + 2 + 1 + 2 + 2 + 1 + 3 = 19  
Путь: (4;9), (5;2), (7;4), (1;6), (10;1), (2;3), (6;5), (8;7), (9;10), (3;8)  
или цикл: (4;9), (9;10), (10;1), (1;6), (6;5), (5;2), (2;3), (3;8), (8;7), (7;4)  
